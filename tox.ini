[tox]
envlist = py{34,35,36}-{core,pytest,testtools,full},docs,pep8

[testenv]
extras =
    core: test-core
    pytest: pytest
    testtools: testtools
    full: test
deps =
    full: coverage
commands =
    core: {envbindir}/python -m unittest discover {posargs:seaworthy/tests-core}
    pytest: pytest {posargs:seaworthy/tests-pytest}
    testtools: {envbindir}/python -m unittest discover {posargs:seaworthy/tests-testtools}
    full: coverage run -m pytest --durations=20 {posargs:seaworthy}
    full: coverage report -m

[testenv:docs]
extras =
    docstest
commands =
    sphinx-build -j4 -T -W -b html -d {envtmpdir}/doctrees docs docs/_build/html
    sphinx-build -j4 -T -W -b latex -d {envtmpdir}/doctrees docs docs/_build/latex
    sphinx-build -j4 -T -W -b doctest -d {envtmpdir}/doctrees docs docs/_build/html
    doc8 README.rst docs/ --ignore-path docs/_build/
    python setup.py check --restructuredtext --strict

[testenv:pep8]
extras =
    pep8test
commands =
    flake8 .

[flake8]
application-import-names = seaworthy
